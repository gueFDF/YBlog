## RPC原理及java实现一个简单的RPC框架

### 前言

最近对分布式感兴趣，说起分布式就连结起了RPC思想，想起来几个月前暑假留校期间完成的chatroom项目是基于Netty框架完成得的，那时候学Netty也浅浅学了一些RPC思想。

常见的RPC技术和框架还有：

- 应用级的服务框架：阿里的 Dubbo/Dubbox、Google gRPC、Spring Boot/Spring Cloud。
- 远程通信协议：RMI、Socket、SOAP(HTTP XML)、REST(HTTP JSON)。
- 通信框架：MINA 和 Netty。



### 关于RPC

比如说现在**我想在本地调用一个远程机器上的函数func，那如何告诉机器我要调用这个方法？**流程如下：

1. 首先客户端要告诉服务器需要调用的函数，此时***函数和进程ID存在一个映射关系***。客户端远程调用时查一下函数然后找到对应的进程ID，就可以执行了。
2. 接下来客户端需要***把本地参数传给远程函数***。如果是本地调用的话直接压栈就好了，但别忘了咱这是远程调用。远程调用过程中不在同个内存中了也就无法直接传递函数参数，此时就使用***序列化和反序列化***传输。
3. 经过第二步此时数据已经准备好了，接下来就开始传输，此时需要一个***网络传输层***把调用的ID和序列化后的参数传给server，然后把序列化好的结果传给client

 

###### RPC指的就是**远程过程调用**。

这个远程调用通常用在网络上，client和server是通过网络连接的。

虽然大部分RPC框架都使用TCP协议，但其实UDP也可以，gRPC直接使用的是HTTP2。反正使用的*协议不限*，能完成传输就成。



### 实现一个基础的RPC

那么如果想要自己实现一个基础的RPC，需要实现三点：

> 1. ***服务寻址***
> 2. ***数据流的序列化和反序列化***
> 3. ***网络传输***

代码详见：https://github.com/yanyanran/JavaJava/tree/main/MyRPC